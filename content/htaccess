ExpiresActive On
ExpiresDefault "access plus 1 day"
ExpiresByType image/png "access plus 1 week"
ExpiresByType image/jpeg "access plus 1 week"
ExpiresByType text/css "access plus 1 week"

SetOutputFilter DEFLATE
SetInputFilter DEFLATE
SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png)$ no-gzip dont-vary
Header append Vary User-Agent env=!dont-vary
Header append Vary Accept-Encoding

AddDefaultCharset utf-8
AddCharset utf-8 .html .css .js .xml .json .rss

Options -MultiViews -Indexes

RedirectMatch permanent ^/irtf/$                               /
RedirectMatch permanent ^/old-groups.html?$                    /groups
RedirectMatch permanent ^/concluded/?$                         /groups
RedirectMatch permanent ^/concluded/groups$                    /groups
RedirectMatch permanent ^/concluded/index$                     /groups
RedirectMatch permanent ^/concluded/chair$                     /chair
RedirectMatch permanent ^/(?:charters/)?irtf$                  /
RedirectMatch permanent ^/index.php$                           /
RedirectMatch permanent ^/charters/(?:rg/)?((?:as|cf|dtn|hip|icc|nm|p2p|r|sam|tm|vn)rg|mobopts).html?$ /$1
RedirectMatch permanent ^/rg/((?:as|cf|dtn|hip|icc|nm|p2p|r|sam|tm|vn)rg|mobopts)$ /$1
RedirectMatch permanent ^/(?:charters/)routing.html?$          /rrg
RedirectMatch permanent ^/(?:charters/)management.html?$       /nmrg
RedirectMatch permanent ^/charters/reliable-multicast.html?$   /samrg
RedirectMatch permanent ^/(?:charters/)?hip$                   /hiprg
RedirectMatch permanent ^/(?:charters|historical/)servmanagement.html?$       /concluded/smrg
RedirectMatch permanent ^/(?:charters|historical/)aaaarch.html?$              /concluded/aaaarch
RedirectMatch permanent ^/(?:charters|historical/)gsec.html?$                 /concluded/gsec
RedirectMatch permanent ^/(?:charters|historical/)siren.html?$                /concluded/siren
RedirectMatch permanent ^/charters/namespace.html?$            /concluded/nsrg
RedirectMatch permanent ^/(.+)/$                               /$1
RedirectMatch permanent ^/rfc/(.*).txt                         http://tools.ietf.org/html/$1

RewriteEngine on

# strip the .html from URLs
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule ^(.*)$ $1.html

# strip the .php from URLs
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php

# strip the www. from URLs
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

# our ssl cert is for *.irtf.org, unfortunately
#RewriteCond %{SERVER_PORT} !^443
#RewriteRule (.*) https://www.irtf.org/$1 [R=301,L]
